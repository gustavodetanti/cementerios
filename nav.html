<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cementerio: ¿un lugar para qué muerte?</title>
    <link rel='stylesheet' href='css/main.css?a=1'>
    <style>
        body {
            margin: 0;
            background-color: #fafafa;
            ;
        }

    </style>
</head>

<body>

    <div class='intro'>
        <img class='full' src='img/home1.jpg'>


        <div class='intro-txt'>

            <div class='dtxt'>
                <h1>Cementerio</h1>
                <h3>¿un lugar para qué muerte?</h3>

                <br><br><br>
                <span class='play'><svg width='48' height='48' id="icon-play3" viewBox="0 0 32 32">
                        <path fill='#bd52ff'
                            d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM16 29c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM12 9l12 7-12 7z">
                        </path>

                    </svg></span>

<span class='explorar'><i>Explorar...</i></span>

            </div>
        </div>

    </div>















    <div class='four-spots'>

        <div class='fs-line'>
            <div>
                <figure class='top-left'>
                    <img src='img/Identidades/Fotoinicio.jpg'>
                    <figcaption data-id="identidades">
                        <h2>Identidades</h2>
                        <h3>Lorem ipsum dolor sit amet consectetur adipisicing elit.</h3>
                    </figcaption>
                </figure>
            </div>



            <div>
                <figure class='top-right'>
                    <img src='img/Otros habitantes/Fotoinicio.jpg'>
                    <figcaption data-id="habitantes">

                        <h2>Otros habitantes</h2>
                        <h3>Lorem ipsum dolor sit amet consectetur adipisicing elit.</h3>
                    

                    </figcaption>
                </figure>
            </div>

        </div>




        <div class='fs-line'>
            <div>
                <figure class='bottom-left'>
                    <img src='img/Cuidadores/Foto de ingreso.jpg'>
                    <figcaption data-id="cuidadores">
                        <h2>Los cuidadores</h2>
                        <h3>Historias intergeneracionales en el trabajo de cuidado</h3>
                    </figcaption>
                </figure>
            </div>

            <div>
                <figure class='bottom-right'>
                    <img src='img/Deudos/La historia de Joaco/3.jpg'>
                    <figcaption data-id="deudos">
                        <h2>Los deudos</h2>
                        <h3>Historias de memoria y de vida</h3>
                    </figcaption>
                </figure>
            </div>
        </div>




    </div>




    <script src='js/jquery-1.12.4.min.js'></script>
    <script>

        $(function () {
            let explorar= $(".intro .explorar").eq(0);
            let introimg = $(".intro img.full").eq(0);
            let playbut = $(".intro .play");
            let h1 = $(".intro .intro-txt h1");
            let h3 = $(".intro .intro-txt h3");

let voice=createAudio('intro',"audios");
            //splash();
            $(".intro").hide();
            $(".four-spots").show()
            $(".four-spots").animate({ opacity: 1 }, 1000);

            function splash() {
                console.log("splash");
                waitLoad(introimg, function () {
                    console.log("loaded");

                    h1.addClass("loaded")
                    setTimeout(() => {
                        h3.addClass("loaded")
                    }, 1000);
                    setTimeout(() => {
                        introimg.addClass("loaded")

                    }, 3000);
                    setTimeout(() => {
                        playbut.addClass("loaded")
                    }, 4000);

                    playbut.click(function () {

voice.play();

playbut.removeClass("loaded");
explorar.addClass('visible');
explorar.click(()=>{
    $(".intro").animate({ opacity: 0 }, 3000, function () {
                            $(".intro").hide();
                            $(".four-spots").animate({ opacity: 1 }, 3000);

                        })


})
return;


                    });
                });




            }




            function waitLoad(img, f) {
                console.log(img);
                var im = new Image();
                im.onload = function () {
                    //console.log("loaded",$(img).attr("src"));
                    img.attr("data-ratio", (this.naturalHeight / this.naturalWidth));
                    f(img);
                };
                im.src = img.attr("src");

            }

        })


        window.addEventListener('DOMContentLoaded', (event) => {
                ini( [...document.querySelectorAll('.four-spots figure figcaption')]);

            });

 
        function ini(spots) {
             
            init()

            function init() {
                console.log(1);
                spots.forEach(element => {
                    element.addEventListener("click", spotClick, false);
                });

            }



            function spotClick(e) {
                if (e) e.preventDefault();
                return;
               let idd=this.getAttribute("data-id");
                var white = document.createElement('div');
                white.classList.add('whiteCover');
                document.body.appendChild(white);
                requestAnimationFrame(() => {
                    white.classList.add('visible');
                 });

                 setTimeout(()=>{
                    window.location.href=idd+"/";
                 },3000);

            }

        }






function createAudio(fname,folder="audios"){
    var audio=document.createElement('audio');
    var source= document.createElement('source');
        source.type= `audio/ogg`;
        source.src= `${folder}/${fname}.ogg`;
        audio.appendChild(source);
        source= document.createElement(`source`);
        source.type= `audio/mpeg`;
        source.src= `${folder}/${fname}.mp3`;
        audio.appendChild(source);
        
return {play:()=>{audio.play()}, 
stop:()=>{
    audio.pause();
}
};
}


    </script>
</body>

</html>